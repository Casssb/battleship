var W=Object.defineProperty;var I=(s,e,t)=>e in s?W(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var b=(s,e,t)=>(I(s,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))n(c);new MutationObserver(c=>{for(const o of c)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(c){const o={};return c.integrity&&(o.integrity=c.integrity),c.referrerpolicy&&(o.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?o.credentials="include":c.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(c){if(c.ep)return;c.ep=!0;const o=t(c);fetch(c.href,o)}})();const A=s=>{const e=document.createElement("div");e.classList.add(`${s}-board`);for(let t=0;t<100;t++){const n=document.createElement("div");n.classList.add(`${s}-tile`),n.setAttribute(`data-${s}`,`${t}`),e.append(n)}return e},M=()=>{const[s,e,t]=document.querySelectorAll(".gameboard"),n=A("player"),c=A("bot"),o=A("start");c.style.cursor="pointer",o.style.cursor="pointer",s.append(n),e.append(c),t.append(o)},E=()=>{const s=document.querySelector(".start-board"),e=document.querySelector(".player-board"),t=document.querySelector(".bot-board");s.remove(),e.remove(),t.remove(),M()},Y=s=>{const e=document.querySelectorAll(".start-tile"),t=s.getShipCoords();e.forEach(n=>{const c=Number(n.dataset.start);t.includes(c)&&n.classList.add("ship")})},q=s=>{const e=document.querySelectorAll(".player-tile"),t=s.getShipCoords();e.forEach(n=>{const c=Number(n.dataset.player);t.includes(c)&&n.classList.add("ship"),s.hitsArray.includes(c)&&n.classList.add("hit"),s.missesArray.includes(c)&&n.classList.add("miss"),s.hasCausedSinking(c)&&n.classList.add("sunk")})},B=s=>{document.querySelectorAll(".bot-tile").forEach(t=>{const n=Number(t.dataset.bot);s.hitsArray.includes(n)&&t.classList.add("hit"),s.missesArray.includes(n)&&t.classList.add("miss"),s.hasCausedSinking(n)&&t.classList.add("sunk")})},z=s=>{document.querySelectorAll(".bot-tile").forEach(t=>{const n=Number(t.dataset.bot);t.addEventListener("click",c=>{const o=c.currentTarget.classList;c.preventDefault(),c.stopImmediatePropagation(),!o.contains("hit")&&!o.contains("miss")&&s(n)})})},p=[[[0,1,2,3,4],[0,10,20,30,40]],[[0,1,2,3],[0,10,20,30]],[[0,1,2],[0,10,20]],[[0,1,2],[0,10,20]],[[0,1],[0,10]]],k=(s,e,t,n)=>{const c=n,o=Number(e.length),r=e[0]+t,i=e[o-1]+t,h=e.some(y=>s.includes(y+t)),m=r>9-o&&r<=9&&i>9||r>19-o&&r<=19&&i>19||r>29-o&&r<=29&&i>29||r>39-o&&r<=39&&i>39||r>49-o&&r<=49&&i>49||r>59-o&&r<=59&&i>59||r>69-o&&r<=69&&i>69||r>79-o&&r<=79&&i>79||r>89-o&&r<=89&&i>89,g=e.some(y=>t+y<0)||e.some(y=>t+y>99);return c===1?!h&&!g:!h&&!g&&!m},F=()=>{const s=[],e=t=>{const n=[],c=s.flat(),o=Math.floor(Math.random()*2),r=o===0?1:10,i=t[o],h=Math.abs(Math.floor(Math.random()*100-i.length*r));k(c,i,h,o)?(i.forEach(m=>{n.push(h+m)}),s.push(n)):e(t)};return e(p[0]),e(p[1]),e(p[2]),e(p[3]),e(p[4]),s};class K{constructor(e,t=null){b(this,"hits",0);this.length=e,t&&(this.coords=[...t])}hit(){this.hits+=1}isSunk(){return this.hits>=this.length}}class V{constructor(e){b(this,"possibleMoves",new Set(this.createMoves()));b(this,"hitsArray",[]);b(this,"missesArray",[]);this.ships=this.createShips(e)}createMoves(e=10){let t=[];for(let n=0;n<e*e;n++)t.push(n);return t}createShips(e){return e.map(t=>new K(t.length,[...t]))}receiveAttack(e){return this.possibleMoves.has(e)?(this.possibleMoves.delete(e),this.handltHitOrMiss(e),1):0}handltHitOrMiss(e){this.ships.forEach(n=>{n.coords.includes(e)&&(n.hit(),this.hitsArray.push(e))}),this.getShipCoords().includes(e)||this.missesArray.push(e)}checkForWin(){return this.ships.filter(e=>e.isSunk()).length===this.ships.length}getShipCoords(){return this.ships.map(e=>e.coords).flat()}hasCausedSinking(e){return this.ships.filter(n=>n.isSunk()).map(n=>n.coords).flat().includes(e)}getSunkCoords(e){return this.ships.filter(t=>t.isSunk()&&t.coords.includes(e)).map(t=>t.coords).flat()}}let l=[];const j=()=>{l.length=0},J=(s,e)=>{const t=e.getSunkCoords(s);l.forEach((n,c)=>{t.includes(n)&&l.splice(c,1)})},Q=s=>{l.forEach(e=>{s.hasCausedSinking(e)&&J(e,s)})},R=(s,e,t)=>{const n=l[0],c=l[1];let o=Math.abs(c-n);const r=Math.max(...l),i=Math.min(...l),h=r+o,m=i-o;if(s.includes(h))return e.includes(h)&&l.push(h),h;if(s.includes(m))return e.includes(m)&&l.push(m),m;if(s.includes(r-o))return e.includes(r-o)&&l.push(r-o),r-o;if(s.includes(i+o))return e.includes(i+o)&&l.push(i+o),i+o;if(o===1)return s.includes(r+10)?(e.includes(r+10)&&l.push(r+10),r+10):s.includes(i-10)?(e.includes(i-10)&&l.push(i-10),i-10):s.includes(r-10)?(e.includes(r-10)&&l.push(r-10),r-10):s.includes(i+10)?(e.includes(i+10)&&l.push(i+10),i+10):v(s,e,t);if(o>=10)return s.includes(r+1)?(e.includes(r+1)&&l.push(r+1),r+1):s.includes(i-1)?(e.includes(i-1)&&l.push(i-1),i-1):s.includes(r-1)?(e.includes(r-1)&&l.push(r-1),r-1):s.includes(i+1)?(e.includes(i+1)&&l.push(i+1),i+1):v(s,e,t)},U=(s,e)=>{const t=l[0];if(s.includes(t+1))return e.includes(t+1)&&l.push(t+1),t+1;if(s.includes(t-1))return e.includes(t-1)&&l.push(t-1),t-1;if(s.includes(t+10))return e.includes(t+10)&&l.push(t+10),t+10;if(s.includes(t-10))return e.includes(t-10)&&l.push(t-10),t-10},v=(s,e,t)=>{const n=s[t];return e.includes(n)&&l.push(n),n},X=s=>{Q(s);const e=[...s.possibleMoves],t=s.getShipCoords(),n=Math.floor(Math.random()*e.length);return l.length>1?R(e,t,n):l.length===1?U(e,t):v(e,t,n)};class N{constructor(e=F(),t=!1){this.board=new V(e),this.turn=t}changeTurn(){this.turn=!this.turn}attack(e,t=null){if(!!this.turn){if(Number.isInteger(t))return e.receiveAttack(t);if(t===null)return e.receiveAttack(X(e))}}}const O=s=>{const e=document.querySelector("#result"),t=document.querySelector("#reset-btn"),n=document.querySelector("#end-modal"),c=r=>{n.style.display="flex",r==="player"&&(e.textContent="You win!"),r==="bot"&&(e.textContent="You lose!")},o=()=>{const r=document.querySelector("#start-modal");E(),G(),n.style.display="none",r.style.display="flex",e.textContent="",j()};t.addEventListener("click",r=>{r.preventDefault(),o()}),c(s)},w=s=>{const e=new N(s,!0),t=new N,n=()=>{e.changeTurn(),t.changeTurn()};z(o=>{e.attack(t.board,o),B(t.board),t.board.checkForWin()&&O("player"),n(),setTimeout(()=>{t.attack(e.board),q(e.board),e.board.checkForWin()&&O("bot"),n()},200)}),Y(e.board),q(e.board),B(t.board)},G=()=>{const s=[];let e=s.flat();const t=document.querySelector("#rotate"),n=document.querySelector("#random-ships"),c=document.querySelector("#start-btn"),o=document.querySelectorAll(".start-tile");let r=0,i=0;const h=()=>{const a=F();s.length=0,s.push(...a),E(),w(s),c.classList.add("go")},m=(a,u)=>{const d=$(a,u);s.push(d),e=s.flat(),i+=1,i>4&&(E(),w(s),c.classList.add("go"))},g=()=>{if(s.length===5){const a=document.querySelector("#start-modal");a.style.display="none",c.classList.remove("go"),s.length=0}},y=()=>{r===0?r=1:r=0},L=a=>{let u;switch(i){case 0:u=p[0][a];break;case 1:u=p[1][a];break;case 2:u=p[2][a];break;case 3:u=p[3][a];break;case 4:u=p[4][a];break;default:u="error, exceeded offset array"}return u},$=(a,u)=>{const d=[];return u.forEach(f=>{d.push(f+a)}),d},C=(a,u)=>{document.querySelector(`[data-start="${a}"]`).classList.add(`${u}`)},T=(a,u)=>{document.querySelector(`[data-start="${a}"]`).classList.remove(`${u}`)},x=a=>{C(a,"hover")},P=a=>{T(a,"hover")},D=a=>{C(a,"clicked")};t.addEventListener("click",a=>{a.preventDefault(),y()}),n.addEventListener("click",a=>{a.preventDefault(),h()}),c.addEventListener("click",a=>{a.preventDefault(),g()}),o.forEach(a=>{a.addEventListener("mouseover",u=>{if(i>4)return;const d=Number(u.currentTarget.dataset.start),f=L(r);k(e,f,d,r)?f.forEach(S=>{x(S+d)}):C(d,"error")})}),o.forEach(a=>{a.addEventListener("mouseout",u=>{if(i>4)return;const d=Number(u.currentTarget.dataset.start),f=L(r);k(e,f,d,r)?f.forEach(S=>{P(S+d)}):T(d,"error")})}),o.forEach(a=>{a.addEventListener("click",u=>{if(i>4)return;const d=Number(u.currentTarget.dataset.start),f=L(r);k(e,f,d,r)&&(f.forEach(S=>{D(S+d)}),m(d,f))})})};M();G();
